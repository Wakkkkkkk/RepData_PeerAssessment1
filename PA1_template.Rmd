---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

Loading the data into R
```{r cache=TRUE}
read.csv("./activity/activity.csv") -> activity
```

```{r}
as.Date(activity$date)->activity$date
```

Splitting it by date
```{r}
split(activity, as.factor(activity$date)) ->sActivity
```

Splitting it by interval
```{r}
split(activity, as.factor(activity$interval)) ->iActivity
```

## What is mean total number of steps taken per day?

Create a function to take the sum of all steps on any given day
```{r}
daysums <- function(frame){
    sum(frame$steps)
}
```

Apply the function over the whole of the list, convert the result to a vector, and take the mean of that vector
```{r}
print("Mean number of steps taken each day")
mean(unlist(lapply(sActivity, daysums)), na.rm= TRUE)
print("Median number of steps taken each day")
median(unlist(lapply(sActivity, daysums)), na.rm= TRUE)
```

## What is the average daily activity pattern?

Create a function to take the mean of all steps across any given interval
```{r}
iMeans <- function(frame){
    sum(frame$steps, na.rm = TRUE)
}
```

Apply the function over the whole of the list, and convert the result to a vector
```{r}
unlist(lapply(iActivity, iMeans)) -> intervalMeans
print("Number of steps taken")
print(head(intervalMeans))
```

## Imputing missing values

Get a named vector which gives na locations
```{r}
is.na(unlist(lapply(sActivity, daysums))) -> nalist
```

```{r}
nearbyNonNAs <- function(index, nalocs){
    indexes <- NA
    for(i in (index-2):(index+2)){
        if(i>0 && i<=length(nalocs) && nalocs[i] == FALSE){
            if(is.na(indexes))
                i -> indexes
            else
                c(indexes,i)->indexes
        }
    }
}
    
```

## Are there differences in activity patterns between weekdays and weekends?
